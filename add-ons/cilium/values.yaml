# see: https://docs.cilium.io/en/stable/installation/cni-chaining-aws-cni/#chaining-aws-cni
cilium:
  cni:
    chainingMode: aws-cni
    exclusive: false
  # as ENI IP addresses can be routed directly in the VPC, we can disable masquerade and tunnel
  enableIPv4Masquerade: false
  tunnel: disabled
  endpointRoutes:
    enabled: true
  routingMode: native 

  # enable hubble
  hubble:
    relay:
      enabled: true
    ui:
      enabled: true

  # needed by Mutual Authentication
  encryption:
    enabled: true
    type: wireguard
  authentication:
    mutual:
      spire:
        enabled: true
        install:
          enabled: true

#  # kube-proxy replacement
#  # k8sServiceHost and k8sServicePort are needed 
#  # because no kube-proxy provisioning the cluster service
#  kubeProxyReplacement: true
#  k8sServiceHost: F64FBD45EE533BC394F728E57E23061E.gr7.us-east-1.eks.amazonaws.com
#  k8sServicePort: 443
#  # k8s ingress support
#  l7Proxy: true
#  nodePort:
#    enabled: true
#  ingressController:
#    enabled: true
#    loadbalancerMode: shared # dedicated